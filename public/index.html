<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>css-loaders preview</title>
  <style>
    * {box-sizing: border-box}
    html, body {width: 100%;height: 100%;margin: 0;padding: 0;}
    body {display: flex;justify-content: center;align-items: center}

    ::-webkit-scrollbar {
      width:  3px;
      height: 3px;
    }

    ::-webkit-scrollbar-track {
      background:    #f1f1f1;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb {
      background:    #888;
      border-radius: 3px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    #xyj {
      width:     90%;
      height:    90%;

      display:   flex;
      flex-wrap: nowrap;


      .left, .right {overflow: auto;height: 100%;}
      .left {
        width:       150px;
        flex-shrink: 0;
        ol {
          margin: 0;
          li {
            cursor: pointer;
            & + li {margin: 5px 0;}
          }
        }
      }
      .right {
        width:         calc(100% - 150px);
        padding:       10px;
        word-break:    break-all;
        white-space:   break-spaces;

        display:       flex;
        flex-wrap:     wrap;
        align-content: flex-start;

        & > div {
          position:          relative;
          counter-increment: item;

          width:             calc(25% - 20px);
          height:            150px;

          margin:            10px;

          display:           flex;
          justify-content:   center;
          align-items:       center;

          &:before {
            content:  counter(item) "";
            position: absolute;
            top:      5px;
            left:     5px;
          }
        }

        @media (max-width: 1024px) {
          & > div {
            width: calc(33.333% - 20px);
          }

        }

        @media (max-width: 768px) {
          & > div {
            width: calc(100% - 20px);
          }
        }
      }
    }
  </style>
</head>
<body>
<div id="xyj">
  <div class="left"></div>
  <div class="right"></div>
</div>
<script type="text/javascript" charset="UTF-8">
  (function () {
    const left = document.querySelector('#xyj .left');
    const right = document.querySelector('#xyj .right');
    fetch('/index.json').then(res => res.json()).then(function (json) {
      const li = [];
      const keys = Object.keys(json);
      keys.forEach(function (key) {
        mountStyle(key, (json[key]).length);
        li.push(`<li class="cursor-pointer" data-key="${key}">${key}</li>`);
      });
      const ol = document.createElement('ol');
      ol.innerHTML = li.join('');
      ol.addEventListener('click', function (e) {
        if (e.target.tagName !== 'LI') {
          return;
        }
        const key = e.target.dataset.key;
        const url = new URL(window.location);
        url.searchParams.set('type', key);
        window.history.replaceState({}, '', url);
        show(key);
      });
      left.appendChild(ol);
      const urlParams = new URLSearchParams(window.location.search);
      const type = urlParams.get('type');
      show(keys.includes(type) ? type : keys[0]);


      function show(key) {
        const content = json[key];
        const html = [];
        content.forEach(function (item) {
          html.push(`<div><div class="${item}"></div></div>`);
        });
        right.innerHTML = html.join('');
      }
    });

    function mountStyle(type, length) {
      for (let i = 1; i <= length; i++) {
        const css = document.createElement('link');
        css.rel = 'stylesheet';
        css.href = `${type}/l${i}.css`;
        css.dataset.origin = "dynamic-create";
        document.head.appendChild(css);
      }
    }
  }());
</script>
</body>
</html>